webpackJsonp([0],{"+mts":function(e,t,a){"use strict";var n=a("woOf"),i=a.n(n),r=a("fZjL"),o=a.n(r),s=a("ms7A"),l=a("0xDb"),c=a("dZuX"),u=a("2QJc"),p=a("9q5R");t.a={name:"taskLog",data:function(){return{form:{taskType:"",taskName:"",startDate:"",endDate:"",taskResult:""},taskTypes:[],taskResults:[],tableData:[],loading:!1,noTableData:"",totalTasks:0,pageSize:10,currentPage:1,multipleSelection:[],dialogAgainExecuteVisible:!1,againExecuteInfo:{},beCompareExecuteParams:{},btnShow:!0,queryContainerShrink:!1}},created:function(){this.getTaskTypeLists(),this.getTaskResults(),this.getTaskLists()},methods:{getTaskTypeLists:function(){var e=this;a.i(s.l)({params:{code:"1037"}}).then(function(t){"0000"===t.errcode&&(e.taskTypes=t.result)})},getTaskResults:function(){var e=this;a.i(s.l)({params:{code:"1038"}}).then(function(t){"0000"===t.errcode&&(e.taskResults=t.result)})},getTaskLists:function(e){var t=this,n=e||1,i=void 0,r=void 0;i=this.form.startDate?a.i(l.a)(this.form.startDate):"",r=this.form.endDate?a.i(l.a)(this.form.endDate):"";var o={pageNo:n,pageSize:this.pageSize,taskType:this.form.taskType,taskName:this.form.taskName,execStartTime:i,execEndTime:r,status:this.taskResult};a.i(c.a)({params:o}).then(function(e){"0000"===e.errcode&&(t.tableData=e.result.rows,t.totalTasks=e.result.totalCount)})},clearQueryParams:function(){for(var e in this.form)this.form[e]=""},queryTaskList:function(){this.getTaskLists(this.currentPage)},handleSelectionChange:function(e){this.multipleSelection=e},handleCurrentChange:function(e){this.currentPage=e,this.getTaskLists(this.currentPage)},handleSizeChange:function(e){this.pageSize=e,this.getTaskLists(this.currentPage)},againExecute:function(){var e=this;1===this.multipleSelection.length?a.i(c.b)({params:this.multipleSelection[0].taskId}).then(function(t){"0000"===t.errcode&&(e.againExecuteInfo=t.result,e.beCompareExecuteParams=JSON.parse(t.result.taskParam),e.dialogAgainExecuteVisible=!0)}):this.$notify.warning({title:"消息",message:0===this.multipleSelection.length?"请选择一条信息查看":"只能选择一条信息查看",duration:600})},handleAgainExecute:function(){var e=this,t=o()(this.beCompareExecuteParams),n=o()(JSON.parse(this.againExecuteInfo.taskParam)),r=!1;if(t.forEach(function(t){if(!n.includes(t))return e.$notify.warning({title:"消息",message:"执行参数不符合要求，请修改",duration:600}),void(r=!0)}),!r&&(n.forEach(function(a){if(!t.includes(a))return e.$notify.warning({title:"消息",message:"执行参数不符合要求，请修改",duration:600}),void(r=!0)}),!r)){var s=i()({taskId:this.againExecuteInfo.id},JSON.parse(this.againExecuteInfo.taskParam));a.i(c.c)({params:s},this.againExecuteInfo.execApi).then(function(t){"0000"===t.errcode&&e.getTaskLists()})}}},watch:{multipleSelection:function(e){e.some(function(e){return"0"===e.status})?this.btnShow=!1:this.btnShow=!0}},mixins:[p.a,u.a]}},"0xDb":function(e,t,a){"use strict";function n(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();n=n<10?"0"+n:n;var i=i<10?"0"+i:i;return a+"-"+n+"-"+i}function i(e){var t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();n=n<10?"0"+n:n;var i=i<10?"0"+i:i;return a+"-"+n+"-"+i+" "+(t.getHours()<10?"0"+t.getHours():t.getHours())+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes())}t.b=n,t.a=i;var r=a("pFYg");a.n(r)},"2QJc":function(e,t,a){"use strict";(function(e){var n=a("Dd8w"),i=a.n(n),r=a("NYxO"),o={data:function(){return{scrollHeight:0,queryContainerShrink:!1}},computed:i()({},a.i(r.c)({isCollapse:function(e){return e.app.sidebar.opened}})),methods:{openNewAddModal:function(){var t=this;setTimeout(function(){t.isCollapse?document.querySelector(".v-modal")&&(document.querySelector(".v-modal").style.left="200px",e(".el-dialog__wrapper").css("left","200px")):(t.$nextTick(function(){document.querySelector(".v-modal").style.left="36px"}),document.querySelector(".v-modal")&&(document.querySelector(".v-modal").style.left="36px",e(".el-dialog__wrapper").css("left","36px"))),document.querySelector(".v-modal")&&(t.scrollHeight=e(document).scrollTop(),t.scrollHeight>=0&&t.scrollHeight<50?(document.querySelector(".v-modal").style.top=50-t.scrollHeight+"px",e(".el-dialog__wrapper").css("top",50-t.scrollHeight+"px")):(document.querySelector(".v-modal").style.top="0px",e(".el-dialog__wrapper").css("top","0px")))},100)},shrinkQueryArea:function(e){this.queryContainerShrink?(this.$refs.queryContainer.style.height=e+"px",this.queryContainerShrink=!1):(this.$refs.queryContainer.style.height="60px",this.queryContainerShrink=!0)}},watch:{isCollapse:function(t){document.querySelector(".v-modal")&&(t?(document.querySelector(".v-modal").style.left="200px",e(".el-dialog__wrapper").css("left","200px")):(document.querySelector(".v-modal").style.left="36px",e(".el-dialog__wrapper").css("left","36px")))}}};t.a=o}).call(t,a("7t+N"))},"9q5R":function(e,t,a){"use strict";(function(e){var n=a("Dd8w"),i=a.n(n),r=a("NYxO"),o={computed:i()({},a.i(r.b)(["buttonAuth"]),{buttonVisible:function(){var e=this,t={};return this.buttonAuth.forEach(function(a){a.menuParentCode===e.pageId&&(t[a.menuCode]=!0)}),t}}),mounted:function(){e(".el-dialog").draggable()}};t.a=o}).call(t,a("7t+N"))},AsUh:function(e,t,a){t=e.exports=a("FZ+f")(!0),t.push([e.i,".query-container{padding:10px;box-shadow:0 0 4px #ccc;position:relative;overflow:hidden;transition:height .5s}.query-container .query-btn{position:absolute;right:40px;bottom:18px}.query-container .draggable{position:absolute;right:0;bottom:18px;width:30px;height:30px;padding-left:5px;line-height:30px;text-align:center;border:1px solid #ccc;opacity:.5;display:none;border-radius:50%}.query-container:hover .draggable{display:block}.manage-container{margin-top:20px;padding:10px;box-shadow:0 0 4px #ccc}.manage-container .el-dialog_wrapper{left:200px;top:50px}.el-button{width:88px}.el-table{margin-top:20px}.page-container{text-align:right;padding-top:10px}.page-container .el-pagination{padding-right:0}.reset-dialog-width .el-dialog{width:30%}.reset-dialog-width .el-dialog p{text-align:center}.el-dialog__body{margin:20px 0 5px;border-top:1px solid #ccc;border-bottom:1px solid #ccc}.v-modal{transition:all .1s;left:200px;top:50px}.svg-icon{margin-right:5px}.task-log{margin:30px auto 0;width:1120px}.task-log .el-dialog__wrapper{top:50px;left:200px}","",{version:3,sources:["/Users/liwenhua/Documents/bwton/SourceCode/01.trunk/back-manage/src/views/taskDispatch/taskLog.vue"],names:[],mappings:"AACA,iBACE,aAAc,AACd,wBAAyB,AACzB,kBAAmB,AACnB,gBAAiB,AACjB,qBAAuB,CACxB,AACD,4BACI,kBAAmB,AACnB,WAAY,AACZ,WAAa,CAChB,AACD,4BACI,kBAAmB,AACnB,QAAS,AACT,YAAa,AACb,WAAY,AACZ,YAAa,AACb,iBAAkB,AAClB,iBAAkB,AAClB,kBAAmB,AACnB,sBAAuB,AACvB,WAAa,AACb,aAAc,AACd,iBAAmB,CACtB,AACD,kCACI,aAAe,CAClB,AACD,kBACE,gBAAiB,AACjB,aAAc,AACd,uBAAyB,CAC1B,AACD,qCACI,WAAY,AACZ,QAAU,CACb,AACD,WACE,UAAY,CACb,AACD,UACE,eAAiB,CAClB,AACD,gBACE,iBAAkB,AAClB,gBAAkB,CACnB,AACD,+BACI,eAAiB,CACpB,AACD,+BACE,SAAW,CACZ,AACD,iCACI,iBAAmB,CACtB,AACD,iBACE,kBAAqB,AACrB,0BAA2B,AAC3B,4BAA8B,CAC/B,AACD,SACE,mBAAoB,AACpB,WAAY,AACZ,QAAU,CACX,AACD,UACE,gBAAkB,CACnB,AACD,UACE,mBAAoB,AACpB,YAAc,CACf,AACD,8BACI,SAAU,AACV,UAAY,CACf",file:"taskLog.vue",sourcesContent:["\n.query-container {\n  padding: 10px;\n  box-shadow: 0 0 4px #ccc;\n  position: relative;\n  overflow: hidden;\n  transition: height .5s;\n}\n.query-container .query-btn {\n    position: absolute;\n    right: 40px;\n    bottom: 18px;\n}\n.query-container .draggable {\n    position: absolute;\n    right: 0;\n    bottom: 18px;\n    width: 30px;\n    height: 30px;\n    padding-left: 5px;\n    line-height: 30px;\n    text-align: center;\n    border: 1px solid #ccc;\n    opacity: 0.5;\n    display: none;\n    border-radius: 50%;\n}\n.query-container:hover .draggable {\n    display: block;\n}\n.manage-container {\n  margin-top: 20px;\n  padding: 10px;\n  box-shadow: 0 0 4px #ccc;\n}\n.manage-container .el-dialog_wrapper {\n    left: 200px;\n    top: 50px;\n}\n.el-button {\n  width: 88px;\n}\n.el-table {\n  margin-top: 20px;\n}\n.page-container {\n  text-align: right;\n  padding-top: 10px;\n}\n.page-container .el-pagination {\n    padding-right: 0;\n}\n.reset-dialog-width .el-dialog {\n  width: 30%;\n}\n.reset-dialog-width .el-dialog p {\n    text-align: center;\n}\n.el-dialog__body {\n  margin: 20px 0 5px 0;\n  border-top: 1px solid #ccc;\n  border-bottom: 1px solid #ccc;\n}\n.v-modal {\n  transition: all .1s;\n  left: 200px;\n  top: 50px;\n}\n.svg-icon {\n  margin-right: 5px;\n}\n.task-log {\n  margin: 30px auto 0;\n  width: 1120px;\n}\n.task-log .el-dialog__wrapper {\n    top: 50px;\n    left: 200px;\n}\n"],sourceRoot:""}])},Cdx3:function(e,t,a){var n=a("sB3e"),i=a("lktj");a("uqUo")("keys",function(){return function(e){return i(n(e))}})},JHso:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"task-log"},[a("div",{ref:"queryContainer",staticClass:"query-container",staticStyle:{height:"166px"}},[a("el-form",{staticStyle:{width:"1072px",margin:"auto"},attrs:{inline:!0,model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"任务类型:"}},[a("el-select",{attrs:{size:"small",filterable:"",clearable:""},model:{value:e.form.taskType,callback:function(t){e.form.taskType=t},expression:"form.taskType"}},e._l(e.taskTypes,function(e){return a("el-option",{key:e.id,attrs:{label:e.caption,value:e.id}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"任务执行时间:"}},[a("el-date-picker",{attrs:{size:"small",type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd HH:mm",placeholder:"开始时间"},model:{value:e.form.startDate,callback:function(t){e.form.startDate=t},expression:"form.startDate"}}),e._v(" 至 "),a("el-date-picker",{attrs:{size:"small",type:"datetime",format:"yyyy-MM-dd HH:mm","value-format":"yyyy-MM-dd",placeholder:"结束时间"},model:{value:e.form.endDate,callback:function(t){e.form.endDate=t},expression:"form.endDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务名称:"}},[a("el-input",{staticStyle:{width:"194px"},attrs:{size:"small"},model:{value:e.form.taskName,callback:function(t){e.form.taskName=t},expression:"form.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务执行结果:"}},[a("el-select",{attrs:{size:"small"},model:{value:e.form.taskResult,callback:function(t){e.form.taskResult=t},expression:"form.taskResult"}},e._l(e.taskResults,function(e){return a("el-option",{key:e.value,attrs:{label:e.caption,value:e.value}})}))],1)],1),e._v(" "),a("div",{staticClass:"query-btn"},[a("el-button",{attrs:{size:"small",type:"primary",icon:"delete"},on:{click:e.clearQueryParams}},[e._v("清空")]),e._v(" "),a("el-button",{attrs:{size:"small",type:"primary",icon:"search"},on:{click:e.queryTaskList}},[e._v("查询")])],1),e._v(" "),a("div",{staticClass:"draggable",on:{click:function(t){e.shrinkQueryArea(166)}}},[a("icon-svg",{attrs:{"icon-class":"hamburger"}})],1)],1),e._v(" "),a("div",{staticClass:"manage-container"},[a("el-row",{attrs:{type:"flex",justify:"start"}},[e.btnShow?a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.againExecute}},[e._v("重新执行")])],1):e._e()],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",attrs:{data:e.tableData,border:"","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)","empty-text":e.noTableData},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection"}}),e._v(" "),a("el-table-column",{attrs:{label:"任务日志ID",prop:"id",width:"120"}}),e._v(" "),a("el-table-column",{attrs:{label:"任务ID",prop:"taskId",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"任务名称",prop:"taskName",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"任务类型",prop:"taskTypeDesc",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"接口地址",prop:"execApi",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"任务参数",prop:"taskParam",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"执行结果",prop:"statusDesc",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"开始时间",prop:"execStartTime",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"结束时间",prop:"execEndTime",width:"180"}}),e._v(" "),a("el-table-column",{attrs:{label:"任务耗时",prop:"timeConsumed",width:"100"}}),e._v(" "),a("el-table-column",{attrs:{label:"失败原因",prop:"failReason",width:"100"}})],1),e._v(" "),a("div",{staticClass:"page-container"},[a("el-pagination",{attrs:{layout:"total, sizes, prev, pager, next, jumper",total:e.totalTasks,"page-size":e.pageSize,"page-sizes":[10,20,30]},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"重新执行",visible:e.dialogAgainExecuteVisible,"close-on-click-modal":!1},on:{open:e.openNewAddModal,"update:visible":function(t){e.dialogAgainExecuteVisible=t}}},[a("el-form",{ref:"newAddUser",staticStyle:{width:"540px",margin:"auto"},attrs:{model:e.againExecuteInfo,"label-width":"78px"}},[a("el-form-item",{attrs:{label:"任务名称:"}},[a("el-input",{attrs:{disabled:""},model:{value:e.againExecuteInfo.taskName,callback:function(t){e.againExecuteInfo.taskName=t},expression:"againExecuteInfo.taskName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务接口:"}},[a("el-input",{attrs:{disabled:""},model:{value:e.againExecuteInfo.execApi,callback:function(t){e.againExecuteInfo.execApi=t},expression:"againExecuteInfo.execApi"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"参数说明:"}},[a("el-input",{attrs:{disabled:""},model:{value:e.againExecuteInfo.taskParamDesc,callback:function(t){e.againExecuteInfo.taskParamDesc=t},expression:"againExecuteInfo.taskParamDesc"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"执行参数:"}},[a("el-input",{attrs:{type:"textarea",rows:10},model:{value:e.againExecuteInfo.taskParam,callback:function(t){e.againExecuteInfo.taskParam=t},expression:"againExecuteInfo.taskParam"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.handleAgainExecute}},[e._v("确 定")]),e._v(" "),a("el-button",{on:{click:function(t){e.dialogAgainExecuteVisible=!1}}},[e._v("取 消")])],1)],1)],1)},i=[],r={render:n,staticRenderFns:i};t.a=r},LBsA:function(e,t,a){var n=a("AsUh");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("4e8df2df",n,!0)},dZuX:function(e,t,a){"use strict";function n(e){var t=e.params;return a.i(o.a)({url:"/schedule/tasklog/list",method:"post",data:t})}function i(e){var t=e.params;return a.i(o.a)({url:"/schedule/tasklog/exec/"+t,method:"get"})}function r(e,t){var n=e.params;return a.i(o.a)({url:t,method:"post",data:n})}t.a=n,t.b=i,t.c=r;var o=a("Vo7i")},fZjL:function(e,t,a){e.exports={default:a("jFbC"),__esModule:!0}},jFbC:function(e,t,a){a("Cdx3"),e.exports=a("FeBl").Object.keys},kTcE:function(e,t,a){"use strict";function n(e){a("LBsA")}Object.defineProperty(t,"__esModule",{value:!0});var i=a("+mts"),r=a("JHso"),o=a("VU/8"),s=n,l=o(i.a,r.a,s,null,null);t.default=l.exports},ms7A:function(e,t,a){"use strict";function n(e){var t=e.params;return a.i(b.a)({url:"/user/list",method:"post",data:t})}function i(e){var t=e.params;return a.i(b.a)({url:"/user/detail/"+t,method:"get"})}function r(e){var t=e.params;return a.i(b.a)({url:"user/add",method:"post",data:t})}function o(e){var t=e.params;return a.i(b.a)({url:"user/exist/"+t,method:"get"})}function s(e){var t=e.params;return a.i(b.a)({url:"user/modify",method:"post",data:t})}function l(e){var t=e.params;return a.i(b.a)({url:"user/cancel",method:"post",data:t})}function c(e){var t=e.params;return a.i(b.a)({url:"user/disable",method:"post",data:t})}function u(e){var t=e.params;return a.i(b.a)({url:"user/enable",method:"post",data:t})}function p(e){var t=e.params;return a.i(b.a)({url:"user/resetPwd/"+t,method:"get"})}function d(e){var t=e.params;return a.i(b.a)({url:"user/setNewPwd",method:"post",data:t})}function m(e){var t=e.params;return a.i(b.a)({url:"user/role/"+t,method:"get"})}function A(e){var t=e.params;return a.i(b.a)({url:"user/menu/"+t,method:"get"})}function g(e){var t=e.params;return a.i(b.a)({url:"user/setRolePermission",method:"post",data:t})}function f(e){var t=e.params;return a.i(b.a)({url:"user/setMenuPermission",method:"post",data:t})}function h(e){var t=e.params;return a.i(b.a)({url:"user/detail/"+t,method:"get"})}function x(e){var t=e.params;return a.i(b.a)({url:"/dict/getDictByCode",method:"post",data:t})}t.k=n,t.c=i,t.e=r,t.b=o,t.d=s,t.g=l,t.h=c,t.i=u,t.j=p,t.a=d,t.m=m,t.o=A,t.n=g,t.p=f,t.f=h,t.l=x;var b=a("Vo7i")},uqUo:function(e,t,a){var n=a("kM2E"),i=a("FeBl"),r=a("S82l");e.exports=function(e,t){var a=(i.Object||{})[e]||Object[e],o={};o[e]=t(a),n(n.S+n.F*r(function(){a(1)}),"Object",o)}}});
//# sourceMappingURL=0.f8207ae847f30d8a8c7c.js.map